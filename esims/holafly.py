from .helpers import requests_soup
from .helpers import export_to_csv

STORE = 'holafly'
FILENAME = "holafly.csv"

def export():
    rows = []
    urls = ["https://esim.holafly.com/esim-albania/", "https://esim.holafly.com/esim-andorra/", "https://esim.holafly.com/esim-antigua-and-barbuda/", "https://esim.holafly.com/esim-argentina/", "https://esim.holafly.com/esim-argeria/", "https://esim.holafly.com/esim-armenia/", "https://esim.holafly.com/esim-aruba/", "https://esim.holafly.com/esim-asia/", "https://esim.holafly.com/esim-australia/", "https://esim.holafly.com/esim-austria/", "https://esim.holafly.com/esim-azerbaijan/", "https://esim.holafly.com/esim-bahrain/", "https://esim.holafly.com/esim-bangladesh/", "https://esim.holafly.com/esim-barbados/", "https://esim.holafly.com/esim-belarus/", "https://esim.holafly.com/esim-belgium/", "https://esim.holafly.com/esim-bermuda/", "https://esim.holafly.com/esim-bolivia/", "https://esim.holafly.com/esim-bosnia-and-herzegovina/", "https://esim.holafly.com/esim-botswana/", "https://esim.holafly.com/esim-brazil/", "https://esim.holafly.com/esmi-british-virgin-island/", "https://esim.holafly.com/esim-brunei/", "https://esim.holafly.com/esim-bulgaria/", "https://esim.holafly.com/esim-cambodia/", "https://esim.holafly.com/esim-cameroon/", "https://esim.holafly.com/esim-canada/", "https://esim.holafly.com/esim-caribbean/", "https://esim.holafly.com/british-cayman-island/", "https://esim.holafly.com/esim-central-african-republic/", "https://esim.holafly.com/esim-chad/", "https://esim.holafly.com/esim-chile/", "https://esim.holafly.com/esim-china/", "https://esim.holafly.com/esim-colombia/", "https://esim.holafly.com/esim-costa-rica/", "https://esim.holafly.com/esim-croatia/", "https://esim.holafly.com/esim-cyprus/", "https://esim.holafly.com/esim-czech-republic/", "https://esim.holafly.com/esim-democratic-republic-of-congo/", "https://esim.holafly.com/esim-denmark/", "https://esim.holafly.com/esim-dominica/", "https://esim.holafly.com/esim-dominican-republic/", "https://esim.holafly.com/esim-ecuador/", "https://esim.holafly.com/esim-egypt/", "https://esim.holafly.com/esim-el-salvador/", "https://esim.holafly.com/esim-estonia/", "https://esim.holafly.com/esim-europe/", "https://esim.holafly.com/esim-faroe-islands/", "https://esim.holafly.com/esim-fiji/", "https://esim.holafly.com/esim-finland/", "https://esim.holafly.com/esim-france/", "https://esim.holafly.com/esim-french-guiana/", "https://esim.holafly.com/esim-georgia/", "https://esim.holafly.com/esim-germany/", "https://esim.holafly.com/esim-ghana/", "https://esim.holafly.com/esim-gibraltar/", "https://esim.holafly.com/esim-greece/", "https://esim.holafly.com/esim-grenada/", "https://esim.holafly.com/esim-guadeloupe/", "https://esim.holafly.com/esim-guatemala/", "https://esim.holafly.com/esim-haiti/", "https://esim.holafly.com/esim-honduras/", "https://esim.holafly.com/esim-hong-kong/", "https://esim.holafly.com/esim-hungary/", "https://esim.holafly.com/esim-iceland/", "https://esim.holafly.com/esim-india/", "https://esim.holafly.com/esim-indonesia/", "https://esim.holafly.com/esim-iran/", "https://esim.holafly.com/esim-ireland/", "https://esim.holafly.com/esim-isle-of-man/", "https://esim.holafly.com/esim-israel/", "https://esim.holafly.com/esim-italy/", "https://esim.holafly.com/esim-ivory-coast/", "https://esim.holafly.com/esim-jamaica/", "https://esim.holafly.com/esim-japan/", "https://esim.holafly.com/esim-jersey/", "https://esim.holafly.com/esim-jordan/", "https://esim.holafly.com/esim-kazakhstan/", "https://esim.holafly.com/esim-kenya/", "https://esim.holafly.com/esim-kuwait/", "https://esim.holafly.com/esim-kyrgyzstan/", "https://esim.holafly.com/esim-laos/", "https://esim.holafly.com/esim-latvia/", "https://esim.holafly.com/esim-liberia/", "https://esim.holafly.com/esim-liechtenstein/", "https://esim.holafly.com/esim-lithuania/", "https://esim.holafly.com/esim-luxembourg/", "https://esim.holafly.com/esim-macao/", "https://esim.holafly.com/esim-madagascar/", "https://esim.holafly.com/esim-malawi/", "https://esim.holafly.com/esim-malaysia/", "https://esim.holafly.com/esim-malta/", "https://esim.holafly.com/esim-martinique/", "https://esim.holafly.com/esim-mauritius/", "https://esim.holafly.com/esim-mexico/", "https://esim.holafly.com/esim-moldova/", "https://esim.holafly.com/esim-monaco/", "https://esim.holafly.com/esim-mongolia/", "https://esim.holafly.com/esim-montenegro/", "https://esim.holafly.com/esim-morocco/", "https://esim.holafly.com/esim-mozambique/", "https://esim.holafly.com/esim-myanmar/", "https://esim.holafly.com/esim-nepal/", "https://esim.holafly.com/esim-new-zealand/", "https://esim.holafly.com/esim-nicaragua/", "https://esim.holafly.com/esim-nigeria/", "https://esim.holafly.com/esim-north-america/", "https://esim.holafly.com/esim-norway/", "https://esim.holafly.com/esim-oman/", "https://esim.holafly.com/esim-pakistan/", "https://esim.holafly.com/esim-panama/", "https://esim.holafly.com/esim-papua-new-guinea/", "https://esim.holafly.com/esim-paraguay/", "https://esim.holafly.com/esim-peru/", "https://esim.holafly.com/esim-philippines/", "https://esim.holafly.com/esim-poland/", "https://esim.holafly.com/esim-portugal/", "https://esim.holafly.com/esim-puerto-rico/", "https://esim.holafly.com/esim-qatar/", "https://esim.holafly.com/esim-republic-of-congo/", "https://esim.holafly.com/esim-reunion/", "https://esim.holafly.com/esim-romania/", "https://esim.holafly.com/esim-russia/", "https://esim.holafly.com/esim-rwanda/", "https://esim.holafly.com/esim-saudi-arabia/", "https://esim.holafly.com/esim-serbia/", "https://esim.holafly.com/esim-seychelles/", "https://esim.holafly.com/esim-sierra-leone/", "https://esim.holafly.com/esim-singapore/", "https://esim.holafly.com/esim-slovakia/", "https://esim.holafly.com/esim-slovenia/", "https://esim.holafly.com/esim-south-africa/", "https://esim.holafly.com/esim-south-america/", "https://esim.holafly.com/south-korea/", "https://esim.holafly.com/esim-spain/", "https://esim.holafly.com/esim-sri-lanka/", "https://esim.holafly.com/esim-saint-kitts-and-nevis/", "https://esim.holafly.com/esim-saint-lucia/", "https://esim.holafly.com/esim-saint-vicent-and-the-granadines/", "https://esim.holafly.com/esim-sudan/", "https://esim.holafly.com/esim-swaziland/", "https://esim.holafly.com/esim-sweden/", "https://esim.holafly.com/esim-switzerland/", "https://esim.holafly.com/esim-taiwan/", "https://esim.holafly.com/esim-tajikistan/", "https://esim.holafly.com/esim-tanzania/", "https://esim.holafly.com/esim-thailand/", "https://esim.holafly.com/esim-netherlands/", "https://esim.holafly.com/esim-tonga/", "https://esim.holafly.com/esim-trinidad-and-tobago/", "https://esim.holafly.com/esim-tunisia/", "https://esim.holafly.com/esim-turkey/", "https://esim.holafly.com/esim-turks-and-caicos/", "https://esim.holafly.com/esim-uganda/", "https://esim.holafly.com/esim-ukraine/", "https://esim.holafly.com/esim-arab-emirates/", "https://esim.holafly.com/esim-united-kingdom/", "https://esim.holafly.com/esim-uruguay/", "https://esim.holafly.com/esim-usa/", "https://esim.holafly.com/esim-uzbekistan/", "https://esim.holafly.com/esim-vanuatu/", "https://esim.holafly.com/esim-vietnam/", "https://esim.holafly.com/esim-yemen/", "https://esim.holafly.com/esim-zambia/"]

    for url in urls:
        soup = requests_soup(url)
        plans = soup.select(".product-variation")

        for product in plans:

            store       = "holafly"
            price       = product.select_one('span > ins').text
            validity    = product.select_one('label > strong').text
            limit       = product.select_one('label > span').text
            network     = "."
            location    = soup.select_one("div > div.wrapper > div > div.product__info > h1 > span:nth-child(2)").text

            for tab in soup.select('#Ficha > ul > li'):
                text = tab.text
                if "network" in text.lower():
                    network = tab.text.split(':')[1]
                    break

            row = [store, price, validity, limit, network, location]
            row = [x.strip() for x in row]
            if row not in rows:
                print(row)
                rows.append(row)
                export_to_csv(FILENAME, rows)

    return rows